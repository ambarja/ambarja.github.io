{
  "hash": "a9dc7fcb6de2703ffe522d34b7a8511d",
  "result": {
    "markdown": "---\ntitle: \"Amazon Bestsellers Data Analysis\"\ndescription: |\n  KMeans and Exploratory Data Analysis.\nauthor:\n  - name: Karat Sidhu\n    url: {}\ndate: 2022-04-26\ncategories:\n  - Algorithm\n  - Data-Analysis\n  - K-Means\nimage: images/logo.png\ntoc: true\ntoc-title: Table of contents\ntoc-location: left\n---\n\n\n\n\n# Amazon Bestsellers\n\n# Loading libraries\n\n``` r\nsuppressPackageStartupMessages(library(tidyverse))\nsuppressPackageStartupMessages(library(skimr))\nsuppressPackageStartupMessages(library(corrplot))\nsuppressPackageStartupMessages(library(RColorBrewer))\n```\n\n# Loading Data\n\n``` r\nbestsellers <- read.csv(\"bestsellers with categories.csv\")\nhead(bestsellers, 2)\n```\n\n    ##                            Name       Author User.Rating Reviews Price Year\n    ## 1 10-Day Green Smoothie Cleanse     JJ Smith         4.7   17350     8 2016\n    ## 2             11/22/63: A Novel Stephen King         4.6    2052    22 2011\n    ##         Genre\n    ## 1 Non Fiction\n    ## 2     Fiction\n\n``` r\nstr(bestsellers)\n```\n\n    ## 'data.frame':    550 obs. of  7 variables:\n    ##  $ Name       : chr  \"10-Day Green Smoothie Cleanse\" \"11/22/63: A Novel\" \"12 Rules for Life: An Antidote to Chaos\" \"1984 (Signet Classics)\" ...\n    ##  $ Author     : chr  \"JJ Smith\" \"Stephen King\" \"Jordan B. Peterson\" \"George Orwell\" ...\n    ##  $ User.Rating: num  4.7 4.6 4.7 4.7 4.8 4.4 4.7 4.7 4.7 4.6 ...\n    ##  $ Reviews    : int  17350 2052 18979 21424 7665 12643 19735 19699 5983 23848 ...\n    ##  $ Price      : int  8 22 15 6 12 11 30 15 3 8 ...\n    ##  $ Year       : int  2016 2011 2018 2017 2019 2011 2014 2017 2018 2016 ...\n    ##  $ Genre      : chr  \"Non Fiction\" \"Fiction\" \"Non Fiction\" \"Fiction\" ...\n\n# Exploring the Data\n\n## Column Names\n\n``` r\nbestsellers %>% colnames()\n```\n\n    ## [1] \"Name\"        \"Author\"      \"User.Rating\" \"Reviews\"     \"Price\"      \n    ## [6] \"Year\"        \"Genre\"\n\n## Checking for missing Values\n\n``` r\nany(is.na(bestsellers))\n```\n\n    ## [1] FALSE\n\n## Data at a glance\n\n``` r\nunique(bestsellers$Year)\n```\n\n    ##  [1] 2016 2011 2018 2017 2019 2014 2010 2009 2015 2013 2012\n\n``` r\nunique(bestsellers$Genre)\n```\n\n    ## [1] \"Non Fiction\" \"Fiction\"\n\n## Data Distribution\n\n``` r\nskim(bestsellers)\n```\n\n|                                                  |             |\n|:-------------------------------------------------|:------------|\n| Name                                             | bestsellers |\n| Number of rows                                   | 550         |\n| Number of columns                                | 7           |\n| \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_   |             |\n| Column type frequency:                           |             |\n| character                                        | 3           |\n| numeric                                          | 4           |\n| \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_ |             |\n| Group variables                                  | None        |\n\nData summary\n\n**Variable type: character**\n\n| skim_variable | n_missing | complete_rate | min | max | empty | n_unique | whitespace |\n|:--------------|----------:|--------------:|----:|----:|------:|---------:|-----------:|\n| Name          |         0 |             1 |   4 | 121 |     0 |      351 |          0 |\n| Author        |         0 |             1 |   2 |  34 |     0 |      248 |          0 |\n| Genre         |         0 |             1 |   7 |  11 |     0 |        2 |          0 |\n\n**Variable type: numeric**\n\n| skim_variable | n_missing | complete_rate |     mean |       sd |     p0 |    p25 |    p50 |      p75 |    p100 | hist  |\n|:--------------|----------:|--------------:|---------:|---------:|-------:|-------:|-------:|---------:|--------:|:------|\n| User.Rating   |         0 |             1 |     4.62 |     0.23 |    3.3 |    4.5 |    4.7 |     4.80 |     4.9 | ▁▁▁▂▇ |\n| Reviews       |         0 |             1 | 11953.28 | 11731.13 |   37.0 | 4058.0 | 8580.0 | 17253.25 | 87841.0 | ▇▂▁▁▁ |\n| Price         |         0 |             1 |    13.10 |    10.84 |    0.0 |    7.0 |   11.0 |    16.00 |   105.0 | ▇▁▁▁▁ |\n| Year          |         0 |             1 |  2014.00 |     3.17 | 2009.0 | 2011.0 | 2014.0 |  2017.00 |  2019.0 | ▇▅▅▅▅ |\n\n## all data formats look good, no conversion needed for now\n\n# Data Visualization\n\n# Genres\n\n## Bestsellers distribution by genre\n\n``` r\nbestsellers %>%\n  group_by(Genre) %>%\n  summarise(books = n()) %>%\n  ggplot(aes(x = \"\", y = books, fill = Genre)) +\n  geom_bar(stat = \"identity\",\n           width = 1,\n           color = \"white\") +\n  coord_polar(\"y\", start = 0) +\n  theme_void() +\n  scale_fill_manual(values = c(\"#ff9900\", \"#000000\"))\n```\n\n![](best_files/figure-gfm/unnamed-chunk-8-1.png)<!-- -->\n\n# Genres through the years\n\n## Bestsellers distribution by genre by year\n\n``` r\nbestsellers %>%\n  group_by(Year, Genre) %>%\n  summarise(sum = n()) %>%\n  ggplot(aes(\n    x = Year,\n    y = sum,\n    fill = Genre\n  )) +\n  geom_col() +\n  theme_minimal() +\n  scale_x_continuous(breaks = seq(2009, 2019, by = 1)) +\n  scale_fill_manual(values = c(\"#ff9900\", \"#000000\")) +\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor = element_blank(),\n    axis.title.y = element_blank(),\n    legend.title = element_blank(),\n    axis.title.x = element_blank()\n  )\n```\n\n    ## `summarise()` has grouped output by 'Year'. You can override using the\n    ## `.groups` argument.\n\n![](best_files/figure-gfm/unnamed-chunk-9-1.png)<!-- -->\n\n# Correlation Analysis\n\n## Is there any correlation seen between the different numerical variables?\n\n``` r\nbestsellers %>%\n  select(User.Rating, Reviews, Price, Year) %>%\n  cor() %>%\n  corrplot::corrplot(\n    type = \"lower\",\n    order = \"hclust\",\n    method = \"color\",\n    addgrid.col = \"darkgray\",\n    outline = T,\n    tl.cex = 1,\n    tl.col = \"black\",\n    col = brewer.pal(n = 6, name = \"RdGy\")\n  )\n```\n\n![](best_files/figure-gfm/unnamed-chunk-10-1.png)<!-- -->\n\n# User Reviews vs Year\n\n## Most reviewed books\n\n``` r\nbestsellers %>% \n  select(Name, Reviews) %>% \n  arrange(desc(Reviews)) %>% \n  head(20) %>% \n  distinct()\n```\n\n    ##                                                                                        Name\n    ## 1                                                                   Where the Crawdads Sing\n    ## 2                                                                     The Girl on the Train\n    ## 3                                                                                  Becoming\n    ## 4                                                                                 Gone Girl\n    ## 5                                                                    The Fault in Our Stars\n    ## 6                                                                  The Nightingale: A Novel\n    ## 7  Fifty Shades of Grey: Book One of the Fifty Shades Trilogy (Fifty Shades of Grey Series)\n    ## 8                                                                               The Martian\n    ## 9                                                               All the Light We Cannot See\n    ## 10                                                                            The Alchemist\n    ##    Reviews\n    ## 1    87841\n    ## 2    79446\n    ## 3    61133\n    ## 4    57271\n    ## 5    50482\n    ## 6    49288\n    ## 7    47265\n    ## 8    39459\n    ## 9    36348\n    ## 10   35799\n\n## Are the number of reviews changing by year?\n\n### Linear Model\n\n``` r\nbestsellers %>% \n  lm(formula = Year ~ Reviews) %>% \n  summary()\n```\n\n    ## \n    ## Call:\n    ## lm(formula = Year ~ Reviews, data = .)\n    ## \n    ## Residuals:\n    ##     Min      1Q  Median      3Q     Max \n    ## -5.5523 -2.5991 -0.3255  2.5354  5.6549 \n    ## \n    ## Coefficients:\n    ##              Estimate Std. Error   t value Pr(>|t|)    \n    ## (Intercept) 2.013e+03  1.861e-01 10816.121  < 2e-16 ***\n    ## Reviews     7.111e-05  1.112e-05     6.396 3.42e-10 ***\n    ## ---\n    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    ## \n    ## Residual standard error: 3.056 on 548 degrees of freedom\n    ## Multiple R-squared:  0.06946,    Adjusted R-squared:  0.06777 \n    ## F-statistic: 40.91 on 1 and 548 DF,  p-value: 3.423e-10\n\n### Data Viz\n\n``` r\nbestsellers %>% \n  ggplot(aes(Year, Reviews, color = Genre))+\n geom_jitter()+\n geom_smooth(method = 'lm', formula = y ~ x )+\n  theme_minimal() +\n    scale_color_manual(values = c(\"#ff9900\", \"#000000\")) +\n    scale_x_continuous(breaks = seq(2009, 2019, by = 1))+\n   theme(\n    panel.grid.minor = element_blank(),\n    legend.title = element_blank(),\n    axis.title.x = element_blank()\n  )\n```\n\n![](best_files/figure-gfm/unnamed-chunk-13-1.png)<!-- -->\n\n# Reviews Distribution\n\n``` r\nbestsellers %>% \n  ggplot(aes(Reviews, ..density..)) +\n  geom_histogram(fill = \"#ff9900\", color = 'black',binwidth = 1000) +\n    geom_density(alpha = 0.5, fill = \"#ff9900\") +\n  theme_minimal() +\n  theme(\n    panel.grid.major = element_blank())\n```\n\n![](best_files/figure-gfm/unnamed-chunk-14-1.png)<!-- -->\n\n# User Ratings vs Year\n\n## Highest Rated Books\n\n``` r\nbestsellers %>% \n  select(Name, User.Rating) %>% \n  arrange(desc(User.Rating)) %>% \n  head(20) %>% \n  distinct()\n```\n\n    ##                                                                                               Name\n    ## 1                                                         Brown Bear, Brown Bear, What Do You See?\n    ## 2                         Dog Man and Cat Kid: From the Creator of Captain Underpants (Dog Man #4)\n    ## 3              Dog Man: A Tale of Two Kitties: From the Creator of Captain Underpants (Dog Man #3)\n    ## 4                  Dog Man: Brawl of the Wild: From the Creator of Captain Underpants (Dog Man #6)\n    ## 5                           Dog Man: Fetch-22: From the Creator of Captain Underpants (Dog Man #8)\n    ## 6            Dog Man: For Whom the Ball Rolls: From the Creator of Captain Underpants (Dog Man #7)\n    ## 7                  Dog Man: Lord of the Fleas: From the Creator of Captain Underpants (Dog Man #5)\n    ## 8  Goodnight, Goodnight Construction Site (Hardcover Books for Toddlers, Preschool Books for Kids)\n    ## 9                                                                         Hamilton: The Revolution\n    ## 10         Harry Potter and the Chamber of Secrets: The Illustrated Edition (Harry Potter, Book 2)\n    ## 11         Harry Potter and the Goblet of Fire: The Illustrated Edition (Harry Potter, Book 4) (4)\n    ## 12        Harry Potter and the Prisoner of Azkaban: The Illustrated Edition (Harry Potter, Book 3)\n    ## 13           Harry Potter and the Sorcerer's Stone: The Illustrated Edition (Harry Potter, Book 1)\n    ## 14                                                                    Humans of New York : Stories\n    ## 15                       Jesus Calling: Enjoying Peace in His Presence (with Scripture References)\n    ##    User.Rating\n    ## 1          4.9\n    ## 2          4.9\n    ## 3          4.9\n    ## 4          4.9\n    ## 5          4.9\n    ## 6          4.9\n    ## 7          4.9\n    ## 8          4.9\n    ## 9          4.9\n    ## 10         4.9\n    ## 11         4.9\n    ## 12         4.9\n    ## 13         4.9\n    ## 14         4.9\n    ## 15         4.9\n\n## Are users rating the bestsellers differently by year?\n\n### Linear Model\n\n``` r\nbestsellers %>% \n  lm(formula = Year ~ Reviews) %>% \n  summary()\n```\n\n    ## \n    ## Call:\n    ## lm(formula = Year ~ Reviews, data = .)\n    ## \n    ## Residuals:\n    ##     Min      1Q  Median      3Q     Max \n    ## -5.5523 -2.5991 -0.3255  2.5354  5.6549 \n    ## \n    ## Coefficients:\n    ##              Estimate Std. Error   t value Pr(>|t|)    \n    ## (Intercept) 2.013e+03  1.861e-01 10816.121  < 2e-16 ***\n    ## Reviews     7.111e-05  1.112e-05     6.396 3.42e-10 ***\n    ## ---\n    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    ## \n    ## Residual standard error: 3.056 on 548 degrees of freedom\n    ## Multiple R-squared:  0.06946,    Adjusted R-squared:  0.06777 \n    ## F-statistic: 40.91 on 1 and 548 DF,  p-value: 3.423e-10\n\n### Data Viz\n\n``` r\nbestsellers %>% \n  ggplot(aes(Year, User.Rating, color = Genre))+\n geom_jitter()+\n geom_smooth(method = 'lm', formula = y ~ x )+\n  theme_minimal() +\n    scale_color_manual(values = c(\"#ff9900\", \"#000000\")) +\n    scale_x_continuous(breaks = seq(2009, 2019, by = 1))+\n   theme(\n    panel.grid.minor = element_blank(),\n    legend.title = element_blank(),\n    axis.title.x = element_blank()\n  )\n```\n\n![](best_files/figure-gfm/unnamed-chunk-17-1.png)<!-- -->\n\n# Ratings Distribution\n\n``` r\nbestsellers %>%\n  ggplot(aes(User.Rating, ..density..)) +\n  geom_histogram(fill = \"#ff9900\",\n                 color = 'black',\n                 binwidth = 0.1) +\n  geom_density(alpha = 0.5, fill = \"#ff9900\") +\n  theme_minimal() +\n  theme(panel.grid.major = element_blank())\n```\n\n![](best_files/figure-gfm/unnamed-chunk-18-1.png)<!-- -->\n\n# Ratings vs Reviews\n\n``` r\nggplot(bestsellers) +\n  aes(\n    x = Reviews,\n    y = User.Rating,\n    colour = Genre,\n    size = Reviews\n  ) +\n  geom_jitter(alpha = 0.45) +\n  scale_color_manual(\n    values = c(Fiction = \"#ff9900\",\n    `Non Fiction` = \"#000000\")\n  ) +\n  theme_minimal()\n```\n\n![](best_files/figure-gfm/unnamed-chunk-19-1.png)<!-- -->\n\n# Price\n\n## Is there a substantial change in price over the years?\n\n### Linear Model\n\n``` r\nbestsellers %>% \n  lm(formula = Year ~ Price) %>% \n  summary()\n```\n\n    ## \n    ## Call:\n    ## lm(formula = Year ~ Price, data = .)\n    ## \n    ## Residuals:\n    ##     Min      1Q  Median      3Q     Max \n    ## -5.5439 -2.6449 -0.0944  2.7708  5.6248 \n    ## \n    ## Coefficients:\n    ##               Estimate Std. Error  t value Pr(>|t|)    \n    ## (Intercept) 2014.58885    0.20945 9618.334  < 2e-16 ***\n    ## Price         -0.04495    0.01232   -3.648 0.000289 ***\n    ## ---\n    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    ## \n    ## Residual standard error: 3.13 on 548 degrees of freedom\n    ## Multiple R-squared:  0.02371,    Adjusted R-squared:  0.02193 \n    ## F-statistic: 13.31 on 1 and 548 DF,  p-value: 0.0002895\n\n``` r\nbestsellers %>% \n  ggplot(aes(Year, Price, color = Genre))+\n geom_jitter()+\n geom_smooth(method = 'lm', formula = y ~ x )+\n  theme_minimal() +\n    scale_color_manual(values = c(\"#ff9900\", \"#000000\")) +\n    scale_x_continuous(breaks = seq(2009, 2019, by = 1))+\n   theme(\n    panel.grid.minor = element_blank(),\n    legend.title = element_blank(),\n    axis.title.x = element_blank()\n  )\n```\n\n![](best_files/figure-gfm/unnamed-chunk-21-1.png)<!-- -->\n\n# Price Distribution\n\n``` r\nbestsellers %>%\n  ggplot(aes(Price, ..density..)) +\n  geom_histogram(fill = \"#ff9900\",\n                 color = 'black',\n                 binwidth = 1.3) +\n  geom_density(alpha = 0.5, fill = \"#ff9900\") +\n  theme_minimal() +\n  theme(panel.grid.major = element_blank())\n```\n\n![](best_files/figure-gfm/unnamed-chunk-22-1.png)<!-- -->\n\n## Most Expensive Books\n\n``` r\nbestsellers %>% \n  select(Name, Price) %>% \n  arrange(desc(Price)) %>% \n  head(20) %>% \n  distinct() %>% \n    ggplot(aes(x =reorder(Name, Price), y = Price,\n              fill = ifelse(Price == max(Price), \"red\",\"grey\"))) +\n  geom_col() +\n  coord_flip() +\n  scale_fill_manual(values = c(\"#000000\", \"#ff9900\")) +\n  theme_minimal() +\n  theme(\n    panel.grid.minor = element_blank(),\n    panel.grid.major.y = element_blank(),\n    legend.position = \"none\",\n    axis.title.y = element_blank()\n  )\n```\n\n![](best_files/figure-gfm/unnamed-chunk-23-1.png)<!-- -->\n\n# Authors\n\n# Most Instances on the best seller list\n\n``` r\nbestsellers %>% \n  group_by(Author) %>% \n  summarise(count = n()) %>% \n  arrange(desc(count)) %>% \n  head(10) %>% \n  ggplot(aes(x =reorder(Author, count), y = count,\n              fill = ifelse(count == max(count), \"red\",\"grey\"))) +\n  scale_y_continuous(breaks = seq(0, 13, by = 1))+\n  geom_col() +\n  coord_flip() +\n  scale_fill_manual(values = c(\"#000000\", \"#ff9900\")) +\n  theme_minimal() +\n  theme(\n    panel.grid.minor = element_blank(),\n    panel.grid.major.y = element_blank(),\n    legend.position = \"none\",\n    axis.title.y = element_blank()\n  )\n```\n\n![](best_files/figure-gfm/unnamed-chunk-24-1.png)<!-- -->\n\n### What were their books?\n\n``` r\nbestsellers %>% \n  filter(Author==\"Jeff Kinney\")\n```\n\n    ##                                                  Name      Author User.Rating\n    ## 1          Cabin Fever (Diary of a Wimpy Kid, Book 6) Jeff Kinney         4.8\n    ## 2             Diary of a Wimpy Kid: Hard Luck, Book 8 Jeff Kinney         4.8\n    ## 3       Diary of a Wimpy Kid: The Last Straw (Book 3) Jeff Kinney         4.8\n    ## 4                 Diary of a Wimpy Kid: The Long Haul Jeff Kinney         4.8\n    ## 5  Dog Days (Diary of a Wimpy Kid, Book 4) (Volume 4) Jeff Kinney         4.8\n    ## 6              Double Down (Diary of a Wimpy Kid #11) Jeff Kinney         4.8\n    ## 7               Old School (Diary of a Wimpy Kid #10) Jeff Kinney         4.8\n    ## 8                                         The Getaway Jeff Kinney         4.8\n    ## 9         The Meltdown (Diary of a Wimpy Kid Book 13) Jeff Kinney         4.8\n    ## 10     The Third Wheel (Diary of a Wimpy Kid, Book 7) Jeff Kinney         4.7\n    ## 11      The Ugly Truth (Diary of a Wimpy Kid, Book 5) Jeff Kinney         4.8\n    ## 12       Wrecking Ball (Diary of a Wimpy Kid Book 14) Jeff Kinney         4.9\n    ##    Reviews Price Year   Genre\n    ## 1     4505     0 2011 Fiction\n    ## 2     6812     0 2013 Fiction\n    ## 3     3837    15 2009 Fiction\n    ## 4     6540    22 2014 Fiction\n    ## 5     3181    12 2009 Fiction\n    ## 6     5118    20 2016 Fiction\n    ## 7     6169     7 2015 Fiction\n    ## 8     5836     0 2017 Fiction\n    ## 9     5898     8 2018 Fiction\n    ## 10    6377     7 2012 Fiction\n    ## 11    3796    12 2010 Fiction\n    ## 12    9413     8 2019 Fiction\n\n# Books\n\n## Most instances on the best sellers list\n\n``` r\nbestsellers %>% \n  group_by(Name) %>% \n  summarise(count = n()) %>% \n  arrange(desc(count)) %>% \n  head(10) %>% \n  ggplot(aes(x =reorder(Name, count), y = count,\n              fill = ifelse(count == max(count), \"red\",\"grey\"))) +\n    scale_y_continuous(breaks = seq(0, 13, by = 1))+\n  geom_col() +\n  coord_flip() +\n  scale_fill_manual(values = c(\"#000000\", \"#ff9900\")) +\n  theme_minimal() +\n  theme(\n    panel.grid.minor = element_blank(),\n    panel.grid.major.y = element_blank(),\n    legend.position = \"none\",\n    axis.title.y = element_blank()\n  )\n```\n\n![](best_files/figure-gfm/unnamed-chunk-26-1.png)<!-- -->\n\n# K - Means Clustering\n\n``` r\ndata_kmeans <- bestsellers[3:6]\ndata_kmeans <- data_kmeans %>% \n  slice(1:20)\n```\n\n``` r\nlibrary(factoextra)\n```\n\n    ## Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa\n\n``` r\ndata_kmeans <- bestsellers[3:6]\ndata_kmeans <- data_kmeans %>% \n  slice(1:20)\n\ndata_kmeans_scaled <- scale(data_kmeans)\ndata_kmeans <- dist(data_kmeans_scaled)\nfviz_nbclust(data_kmeans_scaled, kmeans,\n             method = \"wss\") + # wss means within sum squares\n  labs(subtitle = \"Elbow Method\")\n```\n\n![](best_files/figure-gfm/unnamed-chunk-28-1.png)<!-- -->\n\n``` r\nkmeans_output <- kmeans(data_kmeans_scaled, centers = 3, nstart = 100)\nkmeans_output.clusters <- kmeans_output$cluster\n```\n\n``` r\nbestsellers_mini <- bestsellers %>% \n  slice(1:20)\n```\n\n``` r\nrownames(data_kmeans_scaled) <- paste(bestsellers_mini$Name, 1:dim(bestsellers_mini)[1], sep=\"_\")\n```\n\n``` r\nfviz_cluster(list(data = data_kmeans_scaled, cluster = kmeans_output.clusters)) +\n  theme_minimal() +\n  theme(plot.subtitle = element_text(size = 12,\n                               face = \"italic\"),\n  plot.caption = element_text(size = 9),\n  plot.title = element_text(size = 15,\n                            face = \"bold\")\n) + labs(\n  colour = \"Cluster\",\n  fill = \"Cluster\",\n  shape = \"Cluster\",\n)\n```\n\n![](best_files/figure-gfm/unnamed-chunk-32-1.png)<!-- -->\n\n``` r\ntest <- table(kmeans_output.clusters, bestsellers_mini$Name)\nas.data.frame(test)\n```\n\n    ##    kmeans_output.clusters\n    ## 1                       1\n    ## 2                       2\n    ## 3                       3\n    ## 4                       1\n    ## 5                       2\n    ## 6                       3\n    ## 7                       1\n    ## 8                       2\n    ## 9                       3\n    ## 10                      1\n    ## 11                      2\n    ## 12                      3\n    ## 13                      1\n    ## 14                      2\n    ## 15                      3\n    ## 16                      1\n    ## 17                      2\n    ## 18                      3\n    ## 19                      1\n    ## 20                      2\n    ## 21                      3\n    ## 22                      1\n    ## 23                      2\n    ## 24                      3\n    ## 25                      1\n    ## 26                      2\n    ## 27                      3\n    ## 28                      1\n    ## 29                      2\n    ## 30                      3\n    ## 31                      1\n    ## 32                      2\n    ## 33                      3\n    ## 34                      1\n    ## 35                      2\n    ## 36                      3\n    ## 37                      1\n    ## 38                      2\n    ## 39                      3\n    ## 40                      1\n    ## 41                      2\n    ## 42                      3\n    ## 43                      1\n    ## 44                      2\n    ## 45                      3\n    ## 46                      1\n    ## 47                      2\n    ## 48                      3\n    ## 49                      1\n    ## 50                      2\n    ## 51                      3\n    ## 52                      1\n    ## 53                      2\n    ## 54                      3\n    ## 55                      1\n    ## 56                      2\n    ## 57                      3\n    ##                                                                                                                     Var2\n    ## 1                                                                                          10-Day Green Smoothie Cleanse\n    ## 2                                                                                          10-Day Green Smoothie Cleanse\n    ## 3                                                                                          10-Day Green Smoothie Cleanse\n    ## 4                                                                                                      11/22/63: A Novel\n    ## 5                                                                                                      11/22/63: A Novel\n    ## 6                                                                                                      11/22/63: A Novel\n    ## 7                                                                                12 Rules for Life: An Antidote to Chaos\n    ## 8                                                                                12 Rules for Life: An Antidote to Chaos\n    ## 9                                                                                12 Rules for Life: An Antidote to Chaos\n    ## 10                                                                                                1984 (Signet Classics)\n    ## 11                                                                                                1984 (Signet Classics)\n    ## 12                                                                                                1984 (Signet Classics)\n    ## 13                                                    5,000 Awesome Facts (About Everything!) (National Geographic Kids)\n    ## 14                                                    5,000 Awesome Facts (About Everything!) (National Geographic Kids)\n    ## 15                                                    5,000 Awesome Facts (About Everything!) (National Geographic Kids)\n    ## 16                                                                         A Dance with Dragons (A Song of Ice and Fire)\n    ## 17                                                                         A Dance with Dragons (A Song of Ice and Fire)\n    ## 18                                                                         A Dance with Dragons (A Song of Ice and Fire)\n    ## 19                    A Game of Thrones / A Clash of Kings / A Storm of Swords / A Feast of Crows / A Dance with Dragons\n    ## 20                    A Game of Thrones / A Clash of Kings / A Storm of Swords / A Feast of Crows / A Dance with Dragons\n    ## 21                    A Game of Thrones / A Clash of Kings / A Storm of Swords / A Feast of Crows / A Dance with Dragons\n    ## 22                                                                                        A Gentleman in Moscow: A Novel\n    ## 23                                                                                        A Gentleman in Moscow: A Novel\n    ## 24                                                                                        A Gentleman in Moscow: A Novel\n    ## 25                                                                         A Higher Loyalty: Truth, Lies, and Leadership\n    ## 26                                                                         A Higher Loyalty: Truth, Lies, and Leadership\n    ## 27                                                                         A Higher Loyalty: Truth, Lies, and Leadership\n    ## 28                                                                                             A Man Called Ove: A Novel\n    ## 29                                                                                             A Man Called Ove: A Novel\n    ## 30                                                                                             A Man Called Ove: A Novel\n    ## 31                        A Patriot's History of the United States: From Columbus's Great Discovery to the War on Terror\n    ## 32                        A Patriot's History of the United States: From Columbus's Great Discovery to the War on Terror\n    ## 33                        A Patriot's History of the United States: From Columbus's Great Discovery to the War on Terror\n    ## 34                                                                                               A Stolen Life: A Memoir\n    ## 35                                                                                               A Stolen Life: A Memoir\n    ## 36                                                                                               A Stolen Life: A Memoir\n    ## 37                                                                                      A Wrinkle in Time (Time Quintet)\n    ## 38                                                                                      A Wrinkle in Time (Time Quintet)\n    ## 39                                                                                      A Wrinkle in Time (Time Quintet)\n    ## 40          Act Like a Lady, Think Like a Man: What Men Really Think About Love, Relationships, Intimacy, and Commitment\n    ## 41          Act Like a Lady, Think Like a Man: What Men Really Think About Love, Relationships, Intimacy, and Commitment\n    ## 42          Act Like a Lady, Think Like a Man: What Men Really Think About Love, Relationships, Intimacy, and Commitment\n    ## 43     Adult Coloring Book Designs: Stress Relief Coloring Book: Garden Designs, Mandalas, Animals, and Paisley Patterns\n    ## 44     Adult Coloring Book Designs: Stress Relief Coloring Book: Garden Designs, Mandalas, Animals, and Paisley Patterns\n    ## 45     Adult Coloring Book Designs: Stress Relief Coloring Book: Garden Designs, Mandalas, Animals, and Paisley Patterns\n    ## 46                                                                  Adult Coloring Book: Stress Relieving Animal Designs\n    ## 47                                                                  Adult Coloring Book: Stress Relieving Animal Designs\n    ## 48                                                                  Adult Coloring Book: Stress Relieving Animal Designs\n    ## 49                                                                        Adult Coloring Book: Stress Relieving Patterns\n    ## 50                                                                        Adult Coloring Book: Stress Relieving Patterns\n    ## 51                                                                        Adult Coloring Book: Stress Relieving Patterns\n    ## 52 Adult Coloring Books: A Coloring Book for Adults Featuring Mandalas and Henna Inspired Flowers, Animals, and Paisley…\n    ## 53 Adult Coloring Books: A Coloring Book for Adults Featuring Mandalas and Henna Inspired Flowers, Animals, and Paisley…\n    ## 54 Adult Coloring Books: A Coloring Book for Adults Featuring Mandalas and Henna Inspired Flowers, Animals, and Paisley…\n    ## 55                                                                                                    Alexander Hamilton\n    ## 56                                                                                                    Alexander Hamilton\n    ## 57                                                                                                    Alexander Hamilton\n    ##    Freq\n    ## 1     0\n    ## 2     0\n    ## 3     1\n    ## 4     1\n    ## 5     0\n    ## 6     0\n    ## 7     0\n    ## 8     0\n    ## 9     1\n    ## 10    0\n    ## 11    0\n    ## 12    1\n    ## 13    0\n    ## 14    0\n    ## 15    1\n    ## 16    0\n    ## 17    1\n    ## 18    0\n    ## 19    1\n    ## 20    0\n    ## 21    0\n    ## 22    0\n    ## 23    0\n    ## 24    1\n    ## 25    0\n    ## 26    0\n    ## 27    1\n    ## 28    0\n    ## 29    0\n    ## 30    2\n    ## 31    0\n    ## 32    1\n    ## 33    0\n    ## 34    1\n    ## 35    0\n    ## 36    0\n    ## 37    0\n    ## 38    1\n    ## 39    0\n    ## 40    1\n    ## 41    0\n    ## 42    0\n    ## 43    0\n    ## 44    1\n    ## 45    0\n    ## 46    0\n    ## 47    1\n    ## 48    0\n    ## 49    0\n    ## 50    1\n    ## 51    0\n    ## 52    0\n    ## 53    1\n    ## 54    0\n    ## 55    0\n    ## 56    0\n    ## 57    1\n\n# Hierarchical clustering\n\n``` r\nres <- hcut(data_kmeans_scaled, k = 4, stand = TRUE)\n# Visualize\nfviz_dend(res, rect = TRUE, cex = 0.3,\n          k_colors = c(\"#00AFBB\",\"#2E9FDF\", \"#E7B800\", \"#FC4E07\")) +\n  theme_minimal()\n```\n\n    ## Warning: `guides(<scale> = FALSE)` is deprecated. Please use `guides(<scale> =\n    ## \"none\")` instead.\n\n![](best_files/figure-gfm/unnamed-chunk-34-1.png)<!-- -->\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": [],
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}