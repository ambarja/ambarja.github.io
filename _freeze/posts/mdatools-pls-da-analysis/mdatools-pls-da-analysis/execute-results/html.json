{
  "hash": "524b8456ca9d200d6528e8c3ca0929cd",
  "result": {
    "markdown": "---\ntitle: \"MDATools - PLS-DA Analysis\"\ndescription: |\n  PLS-DA Analysis using the Iris Dataset and MDA-Tools package\nauthor:\n  - name: Karat Sidhu\n    url: {}\ndate: 2022-05-26\nimage: images/logo.png\ncategories:\n  - PLS-DA\n  - Machine Learning\n  - Discriminant Analysis\n  - Dimension Reduction\n  - Algorithm\ntoc: true\ntoc-title: Table of contents\ntoc-location: left\n---\n\n\n\n\n\n# PLS_DA Analysis\n\nUsing the MDA-Tools package^[https://mdatools.com/docs/plsda.html] as an alternative to mixOmics package.\nI have used mixomics before to perform PLS-DA analysis and the method is fairly straightforward^[https://github.com/SidhuK/R_for_Metabolomics/tree/main/PLS-DA], so I would like to explore this \nmethod to compare the two.\n\nPLS-DA is a common algorithm used for metabolomics and other omics datasets^[https://towardsdatascience.com/partial-least-squares-f4e6714452a], and often used for categorization \nof features in metabolomics.\n\n\n## Loading Packages\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mdatools)\n```\n:::\n\n## Getting the data ready\n\n### Data needs to be in the form of vectors with categories\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(iris)\n\ncal.ind = c(1:25, 51:75, 101:125)\nval.ind = c(26:50, 76:100, 126:150)\n\nXc = iris[cal.ind, 1:4]\nXv = iris[val.ind, 1:4]\n\ncc.all = iris[cal.ind, 5]\ncv.all = iris[val.ind, 5]\n\n\nshow(cc.all)\n```\n\n::: {.cell-output-stdout}\n```\n [1] setosa     setosa     setosa     setosa     setosa     setosa    \n [7] setosa     setosa     setosa     setosa     setosa     setosa    \n[13] setosa     setosa     setosa     setosa     setosa     setosa    \n[19] setosa     setosa     setosa     setosa     setosa     setosa    \n[25] setosa     versicolor versicolor versicolor versicolor versicolor\n[31] versicolor versicolor versicolor versicolor versicolor versicolor\n[37] versicolor versicolor versicolor versicolor versicolor versicolor\n[43] versicolor versicolor versicolor versicolor versicolor versicolor\n[49] versicolor versicolor virginica  virginica  virginica  virginica \n[55] virginica  virginica  virginica  virginica  virginica  virginica \n[61] virginica  virginica  virginica  virginica  virginica  virginica \n[67] virginica  virginica  virginica  virginica  virginica  virginica \n[73] virginica  virginica  virginica \nLevels: setosa versicolor virginica\n```\n:::\n\n```{.r .cell-code}\ncc.vir = cc.all == \"virginica\"\ncv.vir = cv.all == \"virginica\"\nshow(cc.vir)\n```\n\n::: {.cell-output-stdout}\n```\n [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[37] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[49] FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[61]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[73]  TRUE  TRUE  TRUE\n```\n:::\n:::\n\n\n## Carry out PLS-DA modelling and look at the summaries\n\n::: {.cell}\n\n```{.r .cell-code}\n# Now we can calibrate the models:  \n  \nm.all = plsda(Xc, cc.all, 3, cv = 1)\nm.vir = plsda(Xc, cc.vir, 3, cv = 1, classname = \"virginica\")\n\nsummary(m.all)\n```\n\n::: {.cell-output-stdout}\n```\n\nPLS-DA model (class plsda) summary\n------------------------------------\nInfo: \nNumber of selected components: 1\nCross-validation: full (leave one out)\n\nClass #1 (setosa)\n    X cumexpvar Y cumexpvar TP FP TN FN Spec. Sens. Accuracy\nCal       91.97       46.36 25  0 50  0     1     1        1\nCv           NA          NA 25  0 50  0     1     1        1\n\nClass #2 (versicolor)\n    X cumexpvar Y cumexpvar TP FP TN FN Spec. Sens. Accuracy\nCal       91.97       46.36  0  0 50 25  1.00     0    0.667\nCv           NA          NA  0  3 47 25  0.94     0    0.627\n\nClass #3 (virginica)\n    X cumexpvar Y cumexpvar TP FP TN FN Spec. Sens. Accuracy\nCal       91.97       46.36 24  5 45  1  0.90  0.96    0.920\nCv           NA          NA 24  6 44  1  0.88  0.96    0.907\n```\n:::\n\n```{.r .cell-code}\nsummary(m.all, nc = 3)\n```\n\n::: {.cell-output-stdout}\n```\n\nPLS-DA model (class plsda) summary\n------------------------------------\nInfo: \nNumber of selected components: 1\nCross-validation: full (leave one out)\n\nClass #3 (virginica)\n    X cumexpvar Y cumexpvar TP FP TN FN Spec. Sens. Accuracy\nCal       91.97       46.36 24  5 45  1  0.90  0.96    0.920\nCv           NA          NA 24  6 44  1  0.88  0.96    0.907\n```\n:::\n\n```{.r .cell-code}\nsummary(m.all$calres, nc = 3)\n```\n\n::: {.cell-output-stdout}\n```\n\nPLS-DA results (class plsdares) summary:\nNumber of selected components: 1\n\nClass #3 (virginica):\n       X expvar X cumexpvar Y expvar Y cumexpvar TP FP TN FN Spec. Sens.\nComp 1   91.969      91.969   46.356      46.356 24  5 45  1  0.90  0.96\nComp 2    5.500      97.468    6.878      53.233 21  5 45  4  0.90  0.84\nComp 3    2.186      99.654    4.816      58.049 24  3 47  1  0.94  0.96\n       Accuracy\nComp 1    0.920\nComp 2    0.880\nComp 3    0.947\n```\n:::\n\n```{.r .cell-code}\nsummary(m.vir)\n```\n\n::: {.cell-output-stdout}\n```\n\nPLS-DA model (class plsda) summary\n------------------------------------\nInfo: \nNumber of selected components: 3\nCross-validation: full (leave one out)\n\nClass #1 (virginica)\n    X cumexpvar Y cumexpvar TP FP TN FN Spec. Sens. Accuracy\nCal       98.53       61.31 24  3 47  1  0.94  0.96    0.947\nCv           NA          NA 24  3 47  1  0.94  0.96    0.947\n```\n:::\n:::\n\n\n## Looking at the confusion Matrix\n\n::: {.cell}\n\n```{.r .cell-code}\ngetConfusionMatrix(m.all$calres)\n```\n\n::: {.cell-output-stdout}\n```\n           setosa versicolor virginica None\nsetosa         25          0         0    0\nversicolor      0          0         5   20\nvirginica       0          0        24    1\n```\n:::\n\n```{.r .cell-code}\ngetConfusionMatrix(m.vir$calres)\n```\n\n::: {.cell-output-stdout}\n```\n          virginica None\nvirginica        24    1\nNone              3   47\n```\n:::\n:::\n\n\n## Various plots available in the MDA-Package\n\nSee the documentation for details^[https://mdatools.com/docs/plsda--performance-plots.html].\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1, 2))\nplotPredictions(m.all)\nplotPredictions(m.vir)\n```\n\n::: {.cell-output-display}\n![](mdatools-pls-da-analysis_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 2))\nplotPredictions(m.all, nc = 1)\nplotPredictions(m.all, nc = 3)\n```\n\n::: {.cell-output-display}\n![](mdatools-pls-da-analysis_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(3, 2))\nplotMisclassified(m.all, nc = 2)\nplotMisclassified(m.vir)\nplotSensitivity(m.all, nc = 2)\nplotSensitivity(m.vir)\nplotSpecificity(m.all, nc = 2)\nplotSpecificity(m.vir)\n```\n\n::: {.cell-output-display}\n![](mdatools-pls-da-analysis_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 2))\nplotRegcoeffs(m.all, ncomp = 3, ny = 3)\nplotRegcoeffs(m.vir, ncomp = 1, show.ci = TRUE)\n```\n\n::: {.cell-output-display}\n![](mdatools-pls-da-analysis_files/figure-html/unnamed-chunk-5-4.png){width=672}\n:::\n:::\n\n\n## Prediction Plots\n\n::: {.cell}\n\n```{.r .cell-code}\nres = predict(m.all, Xv, cv.all)\nsummary(res)\n```\n\n::: {.cell-output-stdout}\n```\n\nPLS-DA results (class plsdares) summary:\nNumber of selected components: 1\n\nClass #1 (setosa):\n       X expvar X cumexpvar Y expvar Y cumexpvar TP FP TN FN Spec. Sens.\nComp 1   92.924      92.924   42.703      42.703 25  1 49  0  0.98     1\nComp 2    4.560      97.484   11.216      53.920 25  0 50  0  1.00     1\nComp 3    1.790      99.274    1.717      55.637 25  0 50  0  1.00     1\n       Accuracy\nComp 1    0.987\nComp 2    1.000\nComp 3    1.000\n\n\nClass #2 (versicolor):\n       X expvar X cumexpvar Y expvar Y cumexpvar TP FP TN FN Spec. Sens.\nComp 1   92.924      92.924   42.703      42.703  0  0 50 25  1.00   0.0\nComp 2    4.560      97.484   11.216      53.920 10  4 46 15  0.92   0.4\nComp 3    1.790      99.274    1.717      55.637 10  6 44 15  0.88   0.4\n       Accuracy\nComp 1    0.667\nComp 2    0.747\nComp 3    0.720\n\n\nClass #3 (virginica):\n       X expvar X cumexpvar Y expvar Y cumexpvar TP FP TN FN Spec. Sens.\nComp 1   92.924      92.924   42.703      42.703 25  4 46  0  0.92  1.00\nComp 2    4.560      97.484   11.216      53.920 25  4 46  0  0.92  1.00\nComp 3    1.790      99.274    1.717      55.637 24  4 46  1  0.92  0.96\n       Accuracy\nComp 1    0.947\nComp 2    0.947\nComp 3    0.933\n```\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\nplotPredictions(res)\n```\n\n::: {.cell-output-display}\n![](mdatools-pls-da-analysis_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nres21 = predict(m.vir, Xv, cv.all)\nsummary(res21)\n```\n\n::: {.cell-output-stdout}\n```\n\nPLS-DA results (class plsdares) summary:\nNumber of selected components: 3\n\nClass #1 (virginica):\n       X expvar X cumexpvar Y expvar Y cumexpvar TP FP TN FN Spec. Sens.\nComp 1   93.107      93.107   54.394      54.394 25  4 46  0  0.92  1.00\nComp 2    1.588      94.695    6.039      60.433 24  4 46  1  0.92  0.96\nComp 3    2.641      97.336   -0.149      60.284 22  4 46  3  0.92  0.88\n       Accuracy\nComp 1    0.947\nComp 2    0.933\nComp 3    0.907\n```\n:::\n\n```{.r .cell-code}\nres22 = predict(m.vir, Xv, cv.vir)\nsummary(res22)\n```\n\n::: {.cell-output-stdout}\n```\n\nPLS-DA results (class plsdares) summary:\nNumber of selected components: 3\n\nClass #1 (virginica):\n       X expvar X cumexpvar Y expvar Y cumexpvar TP FP TN FN Spec. Sens.\nComp 1   93.107      93.107   54.394      54.394 25  4 46  0  0.92  1.00\nComp 2    1.588      94.695    6.039      60.433 24  4 46  1  0.92  0.96\nComp 3    2.641      97.336   -0.149      60.284 22  4 46  3  0.92  0.88\n       Accuracy\nComp 1    0.947\nComp 2    0.933\nComp 3    0.907\n```\n:::\n\n```{.r .cell-code}\npar(mfrow = c(2, 1))\nplotPredictions(res21)\nplotPredictions(res22)\n```\n\n::: {.cell-output-display}\n![](mdatools-pls-da-analysis_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 2))\nplotXResiduals(res21)\nplotYVariance(res22)\n```\n\n::: {.cell-output-display}\n![](mdatools-pls-da-analysis_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n:::\n\n\n## Further Reading:\n\n- MixOmics dataset: http://mixomics.org/ (alternate method in R)\n\n- How to perform PLS-DA using Mixomics: https://github.com/SidhuK/R_for_Metabolomics/tree/main/PLS-DA\n\n",
    "supporting": [
      "mdatools-pls-da-analysis_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": [],
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}